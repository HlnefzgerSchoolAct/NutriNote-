/* ========================================
   NutriNote+ Tailwind CSS v4 Entry Point
   Bridges M3 design tokens into Tailwind
   ======================================== */

@import "tailwindcss";

/* Import M3 Design System Tokens */
@import "./styles/m3-tokens.css";
@import "./styles/typography.css";
@import "./styles/elevation.css";
@import "./styles/breakpoints.css";
@import "./styles/adaptive-layout.css";
@import "./styles/a11y.css";

/* ========================================
   TAILWIND THEME — M3 Token Bridge
   Maps CSS custom properties to Tailwind utilities
   ======================================== */

@theme {
  /* ===== Colors ===== */

  /* Primary */
  --color-primary: var(--md-sys-color-primary);
  --color-on-primary: var(--md-sys-color-on-primary);
  --color-primary-container: var(--md-sys-color-primary-container);
  --color-on-primary-container: var(--md-sys-color-on-primary-container);

  /* Secondary */
  --color-secondary: var(--md-sys-color-secondary);
  --color-on-secondary: var(--md-sys-color-on-secondary);
  --color-secondary-container: var(--md-sys-color-secondary-container);
  --color-on-secondary-container: var(--md-sys-color-on-secondary-container);

  /* Tertiary */
  --color-tertiary: var(--md-sys-color-tertiary);
  --color-on-tertiary: var(--md-sys-color-on-tertiary);
  --color-tertiary-container: var(--md-sys-color-tertiary-container);
  --color-on-tertiary-container: var(--md-sys-color-on-tertiary-container);

  /* Error */
  --color-error: var(--md-sys-color-error);
  --color-on-error: var(--md-sys-color-on-error);
  --color-error-container: var(--md-sys-color-error-container);
  --color-on-error-container: var(--md-sys-color-on-error-container);

  /* Surface System */
  --color-surface: var(--md-sys-color-surface);
  --color-on-surface: var(--md-sys-color-on-surface);
  --color-surface-variant: var(--md-sys-color-surface-variant);
  --color-on-surface-variant: var(--md-sys-color-on-surface-variant);
  --color-surface-dim: var(--md-sys-color-surface-dim);
  --color-surface-bright: var(--md-sys-color-surface-bright);

  /* Surface Container Hierarchy */
  --color-surface-container-lowest: var(--md-sys-color-surface-container-lowest);
  --color-surface-container-low: var(--md-sys-color-surface-container-low);
  --color-surface-container: var(--md-sys-color-surface-container);
  --color-surface-container-high: var(--md-sys-color-surface-container-high);
  --color-surface-container-highest: var(--md-sys-color-surface-container-highest);

  /* Outline */
  --color-outline: var(--md-sys-color-outline);
  --color-outline-variant: var(--md-sys-color-outline-variant);

  /* Inverse */
  --color-inverse-surface: var(--md-sys-color-inverse-surface);
  --color-inverse-on-surface: var(--md-sys-color-inverse-on-surface);
  --color-inverse-primary: var(--md-sys-color-inverse-primary);

  /* Scrim */
  --color-scrim: var(--md-sys-color-scrim);

  /* Macro / Nutrition Colors */
  --color-protein: var(--m3-protein);
  --color-protein-container: var(--m3-protein-container);
  --color-on-protein: var(--m3-on-protein);
  --color-carbs: var(--m3-carbs);
  --color-carbs-container: var(--m3-carbs-container);
  --color-on-carbs: var(--m3-on-carbs);
  --color-fat: var(--m3-fat);
  --color-fat-container: var(--m3-fat-container);
  --color-on-fat: var(--m3-on-fat);
  --color-calories: var(--m3-calories);
  --color-calories-container: var(--m3-calories-container);

  /* Status Colors */
  --color-success: var(--m3-success);
  --color-success-container: var(--m3-success-container);
  --color-warning: var(--m3-warning);
  --color-warning-container: var(--m3-warning-container);
  --color-info: var(--m3-info);
  --color-info-container: var(--m3-info-container);

  /* Extended Colors */
  --color-hydration: var(--m3-hydration);
  --color-hydration-container: var(--m3-hydration-container);
  --color-streak: var(--m3-streak-flame);
  --color-streak-container: var(--m3-streak-container);

  /* ===== Border Radius (M3 Shape System) ===== */
  --radius-none: 0px;
  --radius-xs: 4px;
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 28px;
  --radius-full: 9999px;

  /* ===== Shadows (M3 Elevation) ===== */
  --shadow-elevation-0: none;
  --shadow-elevation-1: 0 1px 2px rgba(0, 0, 0, 0.05);
  --shadow-elevation-2: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-elevation-3: 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.06);
  --shadow-elevation-4: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
  --shadow-elevation-5: 0 20px 25px rgba(0, 0, 0, 0.1), 0 10px 10px rgba(0, 0, 0, 0.04);

  /* ===== Spacing (4px base, M3 aligned) ===== */
  --spacing-0: 0px;
  --spacing-0_5: 2px;
  --spacing-1: 4px;
  --spacing-1_5: 6px;
  --spacing-2: 8px;
  --spacing-2_5: 10px;
  --spacing-3: 12px;
  --spacing-3_5: 14px;
  --spacing-4: 16px;
  --spacing-5: 20px;
  --spacing-6: 24px;
  --spacing-7: 28px;
  --spacing-8: 32px;
  --spacing-9: 36px;
  --spacing-10: 40px;
  --spacing-12: 48px;
  --spacing-14: 56px;
  --spacing-16: 64px;
  --spacing-20: 80px;
  --spacing-24: 96px;

  /* ===== Font Family ===== */
  --font-sans: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-mono: "JetBrains Mono", "Fira Code", "Cascadia Code", monospace;

  /* ===== Font Size (M3 Type Scale) ===== */
  --text-display-lg: 3.5625rem;
  --text-display-md: 2.8125rem;
  --text-display-sm: 2.25rem;
  --text-headline-lg: 2rem;
  --text-headline-md: 1.75rem;
  --text-headline-sm: 1.5rem;
  --text-title-lg: 1.375rem;
  --text-title-md: 1rem;
  --text-title-sm: 0.875rem;
  --text-body-lg: 1rem;
  --text-body-md: 0.875rem;
  --text-body-sm: 0.75rem;
  --text-label-lg: 0.875rem;
  --text-label-md: 0.75rem;
  --text-label-sm: 0.6875rem;

  /* ===== Line Height (M3 Type Scale) ===== */
  --leading-display-lg: 4rem;
  --leading-display-md: 3.25rem;
  --leading-display-sm: 2.75rem;
  --leading-headline-lg: 2.5rem;
  --leading-headline-md: 2.25rem;
  --leading-headline-sm: 2rem;
  --leading-title-lg: 1.75rem;
  --leading-title-md: 1.5rem;
  --leading-title-sm: 1.25rem;
  --leading-body-lg: 1.5rem;
  --leading-body-md: 1.25rem;
  --leading-body-sm: 1rem;
  --leading-label-lg: 1.25rem;
  --leading-label-md: 1rem;
  --leading-label-sm: 1rem;

  /* ===== Font Weight ===== */
  --font-weight-regular: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  /* ===== Z-Index Scale ===== */
  --z-dropdown: 100;
  --z-sticky: 200;
  --z-fixed: 300;
  --z-overlay: 400;
  --z-modal: 500;
  --z-popover: 600;
  --z-tooltip: 700;
  --z-toast: 800;
  --z-max: 999;

  /* ===== Transitions ===== */
  --transition-fast: 100ms ease-out;
  --transition-normal: 200ms ease-out;
  --transition-slow: 300ms ease-out;
  --transition-m3-standard: 300ms cubic-bezier(0.2, 0, 0, 1);
  --transition-m3-emphasized: 500ms cubic-bezier(0.2, 0, 0, 1);
  --transition-m3-emphasized-decel: 400ms cubic-bezier(0.05, 0.7, 0.1, 1);
  --transition-m3-emphasized-accel: 200ms cubic-bezier(0.3, 0, 0.8, 0.15);

  /* ===== Breakpoints ===== */
  --breakpoint-sm: 600px;
  --breakpoint-md: 840px;
  --breakpoint-lg: 1200px;
  --breakpoint-xl: 1600px;
}

/* ========================================
   GLOBAL BASE STYLES
   ======================================== */

@layer base {
  *,
  *::before,
  *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html {
    font-size: 16px;
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    overscroll-behavior-y: contain;
    overflow-x: hidden;
    max-width: 100vw;
  }

  body {
    font-family: var(--font-sans);
    background-color: var(--md-sys-color-surface);
    color: var(--md-sys-color-on-surface);
    line-height: 1.5;
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden;
    overflow-y: auto;
    max-width: 100vw;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-y pan-x;
  }

  /* iOS standalone safe areas */
  @supports (padding-top: env(safe-area-inset-top)) {
    body {
      padding-top: env(safe-area-inset-top);
    }
  }

  /* Scrollbar styling */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background-color: var(--md-sys-color-outline-variant);
    border-radius: var(--radius-full);
  }

  @media (max-width: 599px) {
    ::-webkit-scrollbar {
      display: none;
    }
    body {
      scrollbar-width: none;
    }
  }

  /* Selection */
  ::selection {
    background-color: var(--md-sys-color-primary-container);
    color: var(--md-sys-color-on-primary-container);
  }
}

/* ========================================
   COMPONENT LAYER — Reusable patterns
   ======================================== */

@layer components {
  /* Page container */
  .page {
    @apply min-h-screen pb-24 px-4;
    max-width: 600px;
    margin: 0 auto;
  }

  @media (min-width: 1024px) {
    .page {
      @apply pb-8 pl-70;
      max-width: 900px;
    }
  }

  /* Section wrapper */
  .section {
    @apply mb-6;
  }

  /* Page header */
  .page-header {
    @apply pt-4 pb-2;
  }
}

/* ========================================
   UTILITY LAYER — Custom utilities
   ======================================== */

@layer utilities {
  /* M3 state layer overlay */
  .state-hover::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background-color: currentColor;
    opacity: var(--md-sys-state-hover-opacity);
    pointer-events: none;
  }

  .state-pressed::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background-color: currentColor;
    opacity: var(--md-sys-state-pressed-opacity);
    pointer-events: none;
  }

  /* Truncation */
  .truncate-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .truncate-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Safe area padding */
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
}
